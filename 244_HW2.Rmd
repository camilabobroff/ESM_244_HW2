---
title: "ESM_244_HW2"
author: "Camila Bobroff"
date: "2/14/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load packages, include=FALSE}
library(tidyverse)
library(RColorBrewer)
library(janitor)
```

###Task 1: Data wrangling and visualization - cetations in captivity
```{r Task 1 data, include=FALSE}
captive_cetacean <- read_csv("captive_cetacean.csv")
```

```{r Task 1 exploration, include = FALSE, warning=FALSE}
ggplot(captive_cetacean, aes(x = species))+
  geom_bar()

# Captive cetacean ages graphed separately
captive_dolphin_age <- captive_cetacean %>% 
  filter(species == "Bottlenose", status == "Alive") %>% 
  select(name, sex, birthYear, originLocation, transfers, currently) %>% 
  mutate(age = 2019-as.numeric(birthYear)) %>% 
  ggplot(aes(x = age)) +
  geom_bar()
  
captive_dolphin_age

captive_orca_age <- captive_cetacean %>% 
  filter(species == "Killer Whale; Orca", status == "Alive") %>% 
  select(name, sex, birthYear, originLocation, transfers, currently) %>% 
  mutate(age = 2019-as.numeric(birthYear)) %>% 
  ggplot(aes(x = age)) +
  geom_bar()
  
captive_orca_age

captive_beluga_age <- captive_cetacean %>% 
  filter(species == "Beluga", status == "Alive") %>% 
  select(name, sex, birthYear, originLocation, transfers, currently) %>% 
  mutate(age = 2019-as.numeric(birthYear)) %>% 
  ggplot(aes(x = age)) +
  geom_bar()
  
captive_beluga_age

#Cetaceans currently in captivity
cetacean_alive <- captive_cetacean %>% 
  filter(status == "Alive") %>% 
  ggplot(aes(x = species)) +
  geom_bar()

cetacean_alive

```

```{r Task 1 graph, echo=FALSE, warning=FALSE}
#Top 3 cetacean species in captivity
captive_top3 <- captive_cetacean %>% 
  filter(status == "Alive") %>% 
  count(species) %>% 
  top_n(3)

#Dolphins are the most common cetacean in captivity, followed by Orca and Beluga

captive_top3 <- captive_cetacean %>% 
  filter(species == "Bottlenose" | 
           species == "Killer Whale; Orca" | 
           species == "Beluga", 
         status == "Alive") %>% 
  select(species, name, sex, birthYear, originLocation, transfers, currently) %>% 
  mutate(age = 2019-as.numeric(birthYear)) %>% 
  arrange(desc(species)) 

captive_top3$species <- fct_relevel(captive_top3$species, "Beluga", "Killer Whale; Orca", "Bottlenose") 

captive_ages <- captive_top3 %>% 
  ggplot(aes(x = age)) + 
  geom_bar(aes(fill = species), levels = c("Bottlenose", "Killer Whale; Orca", "Beluga")) +
  scale_fill_manual(values = c("goldenrod3", "coral3", "cadetblue4"), labels = c("Beluga", "Orca", "Bottlenose")) +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous(expand = c(0,0)) +
  theme_minimal() +
  labs(x = "Age", y = "Frequency")

captive_ages

```
**Figure 1. Cetacean Age**  
Sources: 

###Task 2: Parameter Estimation â€“ Wild Fish Catch
```{r Task 2 data, include=FALSE, warning=FALSE}
fish_catch <- read_csv("fish_catch_clean.csv") %>% 
  clean_names() %>% 
  mutate(year = 0:62) %>% 
  select(year, wild_catch)
```

####a) Exploratory graph of wild catch over time
```{r Task 2 exploratory graph, echo=FALSE, warning=FALSE}
# Plot wild catch over time
ggplot(fish_catch, aes(x = year, y = wild_catch)) +
  geom_point()

```

####b) The trend in the exploratory graph of wild catch over time is logistic. 
$N_t = \left(\frac{A}{1 + \beta e^{-rt}}\right)$ 

**Initial Estimates**

- $A = 85$ million tons

- If $N_0$ is estimated at $20$ million tons, $\beta$:  
  $\beta = \frac{(K - N_0)}{N_0} = \frac{(85-20)}{20} = 3.25$   

- $r = .025$

```{r}
# Finding estimates for logistic growth:

# N = A/(1 + Be^(-rt))
# Estimate for carrying capacity: 85
# If N0 is 20, B = ~3.25
# inital r estimate ~ 0.025 (see line 156)

BEstimate <- (85 - 20)/20 # Getting estimates based on the data!

# based on the graph, it looks like exponential growth dominates between year 22 to 35 

# estimate r (the growth rate)
lag_phase <- fish_catch %>% 
  filter(year > 22, year < 35)

ggplot(lag_phase, aes(x = year, y = log(wild_catch))) +
  geom_point() 

lm(log(wild_catch) ~ year, data = fish_catch) 
# r ~ 0.025
```

```{r Task 2 nls, echo=FALSE}

fish_fit <- nls(wild_catch ~ A/(1+B*exp(-r*year)),
                start = list(A = 85, B = 3.25, r = 0.025),
                data = fish_catch, trace = TRUE)

fish_fit

# Store the model coefficients
A <- coef(fish_fit)[1]
B <- coef(fish_fit)[2]
r <- coef(fish_fit)[3]

```

```{r Task 2 graph}
# Create a new sequence of time values (time_seq)
time_seq <- seq(0,65, length = 500) # 100 observations, so it's not so choppy 

# Plug that new sequence into my model with the parameters A, B and r that we found:

fish_pred <- A/(1 + B * exp(-r*time_seq)) # Predictions based on time_seq
# Bind that together with the time_seq data:
pred_df <- data.frame(time_seq, fish_pred)

# Create a graph with the original data and our model predictions:
ggplot(fish_catch, aes(x = year, y = wild_catch)) +
  geom_point(color = "steelblue4", size = 3) +
  geom_line(data = pred_df, aes(x = time_seq, y = fish_pred), color = "gray26", size = 1)
```


###Task 3: Bootstrapped Confidence Interval for Proportions
```{r}



```


###Task 4: Watch 3 RStudio::conf talks
a) Talk title and speaker name
b) Two bulletpoints (for each talk), interesting things that you learned
c) One question that you would have liked to asked the speaker

The next million R users - Carl Howe  
- RStudio's Mission: Equip everyone, regardless of means, to participate in a global economy that rewards data literacy. RStudio Education's mission: Train the next million R users.  
- Males made up 75% of respondents of the survey... not doing as well as anticipated.  
- Inspiring to see that the mean age that folks started using R was age 30! I'm not too late :)  
- What keeps people from using R : Error messages (R users) and languange syntax & getting started (Non-Users, small sample)  
- RStudio primers to learn R on your own!  
Question: How do you plan to increase the diversity of R users, particularly women and people of color?

The resilient R champion - Tonya Filz  
- Barriers faced by R Champion: Open source mentality (why trust open source tools), funding, IT support, internal political pressure.  
- To overcome funding barriers, create demand for data products/assets using Open Source tools. Really show your organization what R can do (i.e. Shiny). Communicate all the possibilities!   
- Ask lots of questions to figure out what the organization really needs and consider whether it can be accomplished using R open source tools. More tools is not always bad.  
Question: What are some examples of organizations that have successfully started using R? Any public sector or non-profit organizaions?

Teaching R using inclusive pedagogy: Practices and lessons learned from over 700 Carpentries workshops - Tracy Teal  
- "Data becomes a tool of profound social change or a weapon of political warfare -- depending on whose hands it is in" Yeshimabeit Milner, Executive Director and Founder of Data for Black Lives. Data is power and the questions asked will depend on who is asking them.  
- The Carpentries is an open, global community teaching researchers the skills to turn data into knowledge.  
- Growth mindset with inclusive pedagogy - confidence, focus on effort and incremental learning, not outcomes. Seeing mistakes as opportunities for learning, safe space for continues learning.  
Question: What are some changes that The Carpentries will be making in order to reach more broad and diverse communities?
